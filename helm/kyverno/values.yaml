# Kyverno Helm Chart Values
# Kubernetes policy engine for validation and mutation

kyverno:
  enabled: true

  # Image
  image:
    repository: ghcr.io/kyverno/kyverno
    tag: v1.12.0
    pullPolicy: IfNotPresent

  # Replicas for HA
  replicaCount: 1

  # Resource limits
  resources:
    requests:
      cpu: 100m
      memory: 256Mi
    limits:
      cpu: 500m
      memory: 1Gi

  # Service account
  serviceAccount:
    create: true
    name: kyverno

  # RBAC
  rbac:
    create: true

  # Pod security context
  podSecurityContext:
    runAsNonRoot: true
    runAsUser: 1000

  securityContext:
    allowPrivilegeEscalation: false
    capabilities:
      drop:
      - ALL
    readOnlyRootFilesystem: true

  # Validating admission webhook
  validatingAdmissionWebhook:
    enabled: true
    failurePolicy: fail

  # Mutating admission webhook
  mutatingAdmissionWebhook:
    enabled: true
    failurePolicy: fail

  # Background scans
  backgroundScan:
    enabled: true

  # Config
  config:
    # Webhook timeout
    webhookTimeout: 30
    # Apply policies to pods generated by these controllers
    excludeKinds:
    - Pod
    - Binding
    - ReplicaSet
    - ReportChangeRequest
    - ClusterReportChangeRequest

  # Service Monitor for Prometheus
  serviceMonitor:
    enabled: true
    namespace: monitoring
    interval: 30s

# Policies (will be defined separately if needed)
policies:
  enabled: false

# Pod disruption budget
podDisruptionBudget:
  enabled: false

# Node selector
nodeSelector: {}

# Tolerations
tolerations: []
